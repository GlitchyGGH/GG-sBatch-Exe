@echo off
title SYSTEM NUKE - USE AT YOUR OWN RISK
color 0c

echo WARNING: THIS WILL DELETE PRETTY MUCH EVERYTHING. CTRL+C NOW IF YOU ARE UNSURE.
pause

:: Kill explorer so we can wipe files without locks
taskkill /f /im explorer.exe

:: Nuke Program Files
rmdir /s /q "C:\Program Files"
rmdir /s /q "C:\Program Files (x86)"

:: Nuke installed Windows Store Apps
PowerShell -command "Get-AppxPackage | Remove-AppxPackage"

:: Wipe all user profiles except current admin's shell
for /d %%a in (C:\Users\*) do (
    if /i not "%%a"=="%userprofile%" (
        rmdir /s /q "%%a"
    )
)

:: Clear ProgramData (where most app settings hide)
rmdir /s /q "C:\ProgramData"

:: Reset everything on your profile except Desktop/Recycle bin pointer
for /d %%a in (%userprofile%\*) do (
    if /i not "%%a"=="%userprofile%\Desktop" (
        if /i not "%%a"=="%userprofile%\Links" (
            rmdir /s /q "%%a"
        )
    )
)

:: Delete most files in Windows directory except core system
del /f /s /q "C:\Windows\*.tmp"
del /f /s /q "C:\Windows\Prefetch\*.*"

:: Relaunch explorer
start explorer.exe

echo.
echo SYSTEM PURGE COMPLETED (minus Recycle Bin). Time to reinstall your shit.
pause
exit
